<html>
  <head>
    <link rel="stylesheet" type="text/css" href="/demos/style.css">
    <style>
      .ember-list-item-view {
        position: absolute;
        width: 500px;
        border-bottom: 1px solid gray;
        border-top: 1px solid gray;
      }

      .row {
        position: absolute;
      }
      .dog {
        height: 50px;
        background-color: teal;
      }
      .cat {
        height: 100px;
        background-color: pink;
      }
      .other {
        height: 150px;
        background-color: purple;
      }
    </style>
    <script type="text/javascript" src="/bower_components/jquery/jquery.js"></script>
    <script type="text/javascript" src="/bower_components/handlebars/handlebars.js"></script>
    <script type="text/javascript" src="/bower_components/ember/ember.prod.js"></script>
    <script type="text/javascript" src="/bower_components/pack/index.js"></script>
    <script type="text/javascript" src="/dist/list-view.js"></script>
    <script type="text/javascript" src="app.js"></script>
 
  </head>

  <body>
    <ul id="menu">
      <li><a href="/demos/">< Demos</a></li>
    </ul>

    <script type="text/x-handlebars"
            data-template-name="list-item">
      {{name}}#{{id}}
    </script>

    <script type="text/x-handlebars">
      <form id="configurator">
        <ul>
          <li>
            <label>
              <div class="description">Height:</div>
              {{input type='range' min=50 max=1000 value=height}}
              {{input type="number" value=height}}
            </label>
          </li>
          <li>
            <label>
              <div class="description">Width:</div>
              {{input type='range' min=50 max=1000 value=width}}
              {{input type="number" value=width}}
            </label>
         </li>
          <li>
            <label>
              <div class="description">ElementWidth:</div>
              {{input type='range' min=50 max=width value=elementWidth}}
              {{input type="number" value=elementWidth}}
            </label>
          </li>
          <li>
            <label>
              <div class="description">Items:</div>
              {{input type='range' min=0 max=maxItemCount value=itemCount}}
              {{input type="number" value=itemCount}}
            </label>
          </li>
        </ul>
      </form>
 
      {{view 'list' content=controller
                    height=height
                    width=width
                    rowHeight=rowHeight
                    elementWidth=elementWidth}}
    </script>

    <script>
      window.data = [
        { height: 100,                  name: "Andrew"   },
        { height: 100,                  name: "Xbar"     },
        { height:  25, width: Infinity, name: "Caroline" },
        { height: 100,                  name: "David"    },
        { height: 100,                  name: "Xbar"     },
        { height: 100,                  name: "Xbar"     },
        { height:  25, width: Infinity, name: "Caroline" },
        { height:  25, width: Infinity, name: "Caroline" },
        { height: 100,                  name: "Edward"   },
        { height:  25, width: Infinity, name: "Caroline" }
      ];

      // rowHeight + elementWidth are fallback dimensions
      App.ListView.reopen({
        height: 500,
        width: 500,
        heightForIndex: function(idx) {
          var ret = Ember.get(Ember.A(this.get('content')).objectAt(idx), 'height');
          if (ret === null) {
            ret = Infinity;
          }
          return ret;
        },

        widthForIndex: function(idx) {
          var ret = Ember.get(Ember.A(this.get('content')).objectAt(idx), 'width');

          if (ret === null) {
            ret = Infinity; // Infinity doesn't JSON.stringify
          } else if (ret === undefined) {
            ret = this.get('elementWidth');
          }

          return ret;
        }
      });
    </script>
  </body>
</html>
